// Модуль определения моделей данных и структур
// Содержит функции создания и обработки структур данных

#Область ПрограммныйИнтерфейс

// Функция создания структуры пользователя
//
// Параметры:
//  Имя - Строка - имя пользователя
//  Email - Строка - email пользователя
//  Возраст - Число - возраст пользователя
//
// Возвращаемое значение:
//  Структура - структура с данными пользователя
//
Функция СоздатьПользователя(Имя, Email, Возраст = 0) Экспорт
    
    Пользователь = Новый Структура;
    Пользователь.Вставить("Имя", Имя);
    Пользователь.Вставить("Email", Email);
    Пользователь.Вставить("Возраст", Возраст);
    Пользователь.Вставить("ДатаСоздания", ТекущаяДата());
    
    Возврат Пользователь;
    
КонецФункции

// Функция создания структуры адреса
//
// Параметры:
//  Город - Строка - название города
//  Улица - Строка - название улицы
//  Дом - Строка - номер дома
//
// Возвращаемое значение:
//  Структура - структура с данными адреса
//
Функция СоздатьАдрес(Город, Улица, Дом) Экспорт
    
    Адрес = Новый Структура;
    Адрес.Вставить("Город", Город);
    Адрес.Вставить("Улица", Улица);
    Адрес.Вставить("Дом", Дом);
    
    Возврат Адрес;
    
КонецФункции

// Функция создания полного профиля пользователя
//
// Параметры:
//  ДанныеПользователя - Структура - базовые данные пользователя
//  ДанныеАдреса - Структура - данные адреса
//
// Возвращаемое значение:
//  Структура - полный профиль пользователя
//
Функция СоздатьПрофильПользователя(ДанныеПользователя, ДанныеАдреса) Экспорт
    
    Профиль = Новый Структура;
    Профиль.Вставить("Пользователь", ДанныеПользователя);
    Профиль.Вставить("Адрес", ДанныеАдреса);
    Профиль.Вставить("Активен", Истина);
    
    Возврат Профиль;
    
КонецФункции

// Процедура обновления данных пользователя
//
// Параметры:
//  Пользователь - Структура - структура пользователя
//  НовоеИмя - Строка - новое имя (необязательный)
//  НовыйEmail - Строка - новый email (необязательный)
//
Процедура ОбновитьПользователя(Пользователь, НовоеИмя = "", НовыйEmail = "") Экспорт
    
    Если НЕ ПустаяСтрока(НовоеИмя) Тогда
        Пользователь.Имя = НовоеИмя;
    КонецЕсли;
    
    Если НЕ ПустаяСтрока(НовыйEmail) Тогда
        Пользователь.Email = НовыйEmail;
    КонецЕсли;
    
    Пользователь.Вставить("ДатаОбновления", ТекущаяДата());
    
КонецПроцедуры

// Функция получения полного имени из профиля
//
// Параметры:
//  Профиль - Структура - профиль пользователя
//
// Возвращаемое значение:
//  Строка - полное имя пользователя
//
Функция ПолучитьПолноеИмя(Профиль) Экспорт
    
    Если НЕ Профиль.Свойство("Пользователь") Тогда
        Возврат "";
    КонецЕсли;
    
    Пользователь = Профиль.Пользователь;
    Возврат Пользователь.Имя;
    
КонецФункции

// Функция получения адреса из профиля в виде строки
//
// Параметры:
//  Профиль - Структура - профиль пользователя
//
// Возвращаемое значение:
//  Строка - адрес в формате "Город, Улица, Дом"
//
Функция ПолучитьАдресСтрокой(Профиль) Экспорт
    
    Если НЕ Профиль.Свойство("Адрес") Тогда
        Возврат "";
    КонецЕсли;
    
    Адрес = Профиль.Адрес;
    АдресСтрокой = СтрШаблон("%1, %2, %3", Адрес.Город, Адрес.Улица, Адрес.Дом);
    
    Возврат АдресСтрокой;
    
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Служебная функция валидации структуры пользователя
//
// Параметры:
//  Пользователь - Структура - проверяемая структура
//
// Возвращаемое значение:
//  Булево - истина, если структура валидна
//
Функция ВалидироватьПользователя(Пользователь)
    
    ОбязательныеПоля = Новый Массив;
    ОбязательныеПоля.Добавить("Имя");
    ОбязательныеПоля.Добавить("Email");
    
    Для Каждого Поле Из ОбязательныеПоля Цикл
        Если НЕ Пользователь.Свойство(Поле) Тогда
            Возврат Ложь;
        КонецЕсли;
    КонецЦикла;
    
    Возврат Истина;
    
КонецФункции

#КонецОбласти












