// Основной модуль для тестирования BSL Language Server
// Демонстрирует различные конструкции языка 1С:Предприятие

// Глобальные переменные
Перем ИмяПриложения Экспорт;
Перем Счетчик;

#Область ПрограммныйИнтерфейс

// Функция приветствия пользователя
//
// Параметры:
//  ИмяПользователя - Строка - имя пользователя для приветствия
//  ТипПриветствия - Строка - тип приветствия (официальное, неофициальное)
//
// Возвращаемое значение:
//  Строка - строка приветствия
//
Функция ПриветствоватьПользователя(ИмяПользователя, ТипПриветствия = "Обычное") Экспорт
    
    Перем Приветствие;
    
    Если ТипПриветствия = "Официальное" Тогда
        Приветствие = СтрШаблон("Добрый день, %1!", ИмяПользователя);
    ИначеЕсли ТипПриветствия = "Неофициальное" Тогда
        Приветствие = СтрШаблон("Привет, %1!", ИмяПользователя);
    Иначе
        Приветствие = СтрШаблон("Здравствуйте, %1!", ИмяПользователя);
    КонецЕсли;
    
    Возврат Приветствие;
    
КонецФункции

// Процедура обработки массива элементов
//
// Параметры:
//  МассивЭлементов - Массив - массив элементов для обработки
//  ТипОперации - Строка - тип операции (подсчет, вывод)
//
Процедура ОбработатьЭлементы(МассивЭлементов, ТипОперации = "Подсчет") Экспорт
    
    Для Каждого Элемент Из МассивЭлементов Цикл
        
        Если ТипОперации = "Подсчет" Тогда
            Счетчик = Счетчик + 1;
            Сообщить(СтрШаблон("Обработка элемента %1: %2", Счетчик, Элемент));
        ИначеЕсли ТипОперации = "Вывод" Тогда
            Сообщить(СтрШаблон("Элемент: %1", Элемент));
        Иначе
            ВызватьИсключение "Неизвестный тип операции: " + ТипОперации;
        КонецЕсли;
        
    КонецЦикла;
    
КонецПроцедуры

// Функция расчета суммы элементов массива
//
// Параметры:
//  МассивЧисел - Массив из Число - массив чисел для суммирования
//
// Возвращаемое значение:
//  Число - сумма элементов массива
//
Функция РассчитатьСумму(МассивЧисел) Экспорт
    
    Перем Сумма;
    Сумма = 0;
    
    Для Каждого Число Из МассивЧисел Цикл
        Сумма = Сумма + Число;
    КонецЦикла;
    
    Возврат Сумма;
    
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// Служебная процедура инициализации
Процедура Инициализация()
    
    ИмяПриложения = "Тестовое приложение BSL";
    Счетчик = 0;
    
КонецПроцедуры

// Служебная функция проверки валидности данных
//
// Параметры:
//  Значение - Произвольный - проверяемое значение
//
// Возвращаемое значение:
//  Булево - истина, если значение валидно
//
Функция ПроверитьВалидность(Значение)
    
    Если Значение = Неопределено Тогда
        Возврат Ложь;
    КонецЕсли;
    
    Если ТипЗнч(Значение) = Тип("Строка") И ПустаяСтрока(Значение) Тогда
        Возврат Ложь;
    КонецЕсли;
    
    Возврат Истина;
    
КонецФункции

#КонецОбласти

// Инициализация модуля
Инициализация();












